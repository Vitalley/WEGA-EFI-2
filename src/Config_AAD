#include <xc.h>

// Порты ввода-вывода
#define	INJ1	LC0	// Управление форсункой PEACK
#define	INJ2	LC1	// Управление форсункой HOLD
#define	INJ3	LC2
#define	INJ4	LC3
#define	INJ5	LC4
#define	INJ6	LC5


#define	IGN1	LD3

#define	PUMP	LD0	// Управление бензонасосом
#define	IDLE	LD1	// Эмуляция концевика ХХ
#define	STEPA	LB4	// Выход линии А на драйвер ШД
#define	STEPB	LB3	// Выход линии Б на драйвер ШД
#define	ACCEL	LD2	// Сигнализация обогащения по ускорению (УН)
#define	WARM_UP	LD4	// Сигнал режима прогрева
#define	PIN1	PORTA,4	// Тумблер РХХ


#define Base_Req_Fuel	5000
#define LPG_Req_Fuel	10000

//Блок настройки шаговоро  регулятора ХХ
#define	IAC_COLT	110	// количество шагов на открытие после инициализации для -40 С(80)
#define	IAC_WARM	25	// количество шагов на открытие после инициализации для +77 С(20)
#define	IAC_MAX		210	// количество шагов для максимального закрытия клапана (100)
#define	IAC_MIN		6	// Минимальное положение РХХ
//Настройка положения ДПДЗ
#define	IAC_SKIP	600	// положение дросселя для начала регулирования (mV)
#define	FL_CLEAR	3027	// положение дросселя для включения режима продувки (mV)
//Настройка параметров двигателя
#define	PR_PULSE	1000	// Время подготовительного импульса впрыска (2мс)
#define	WARM_TRSH	54	//температура включчения прогревочных оборотов
#define	SPD_HOT		850	// Обороты холостого хода (850)
#define	SPD_COLT	1250	// Обороты холостого хода при прогреве (1250)
#define	SPD_EPHH	1400	// Обороты включения экономайзера принудительного холостого хода
#define	DEMFER		26	// Демфер сброса педали акселератора
#define	ACL_THR		5	// Accelerate theshold
#define Inject_Mode	0
#define	CH_Inject	4
#define	Cyl		4	// Количество цилиндров у двигателя по соответствии 4т
#define MAP_type		2	// Датчик давления во впускном коллекторе
#define MAP_LPG_type	3	// Датчик давления газа
//Лаг форсунки в зависимости от напряжения
//                     	      8.6  10.2 11.8 13.4 15
const unsigned int LAG[5] =   {2400,1690,1450,1250,1010};//ZMZ6354 194CC
const unsigned int LAG_LPG[5]={5600,4300,3500,3000,2400};//Lovato LP


//Настройка времени впрыска при старте двигателя
#define	CRANK_HOT	3000	// время впрыска при запуске на горячую (>80)
#define	CRANK_COLT	30000	// время впрыска при запуске на холодную (-40)


//Настройка аналоговых входов
#define	ADC_MAP		ADC_CH0	// AN0 Датчик абсолютного давления
#define	ADC_TPS		ADC_CH1	// AN1 Датчик положения дроссельной заслонки
#define	ADC_COLT	ADC_CH2	// AN2 Датчик температуры ОЖ
#define	ADC_PWR		ADC_CH4	// AN3 Измеритель напряжения бортсети (делитель 4к/1к)
#define	ADC_IAT		ADC_CH3	// AN4 Потенциометр качества смеси
#define	ADC_LAMBDA	ADC_CH5 // Датчик кислорода
#define	ADC_EX		ADC_CH25//      

